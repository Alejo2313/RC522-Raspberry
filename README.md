based on Tilen Majerle code for STM32. Needs wiringPi library
